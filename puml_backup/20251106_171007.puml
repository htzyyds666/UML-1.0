@startuml
skinparam defaultFontName 微软雅黑
title 类图

' 父类，抽象通用属性
class "用户" {
  - 用户id: string
  - 姓名: string
  - 密码: string
  --
  + 登录()
  + 注销()
}

' 管理员继承用户，删去重复姓名属性
class "管理员" {
  - 工号: string
  --
  + 审核打卡异常()
  + 设置运动规则()
  + 处理违规行为()
  + 管理运动规则(规则: 运动规则) ' 新增方法，明确管理员通过此方法使用运动规则
}

' 学生继承用户，姓名归用户，健康数据类型调整为健康分析引用
class "学生" {
  - 学号: string
  - 健康分析数据: 健康分析 ' 将健康数据属性明确为健康分析类型
  --
  + 打卡()
  + 查看健康报告()
  + 申诉打卡异常()
  + 暂停跑步()
  + 查看运动次数()
}

class "健康分析" {
  - 运动数据列表: List<运动数据> ' 将属性设为私有，并明确为集合，避免模糊责任
  - 心率: float
  - 建议: string
  --
  + 生成健康报告()
  + 获取运动数据(): List<运动数据> ' 通过方法访问运动数据
  + 添加运动数据(数据: 运动数据)
}

class "运动数据" {
  - 时间: date
  - 距离: float
  - 配速: float
  - 是否有效: boolean
  - 消耗卡路里: float ' 纠正属性名，移除多余“里”
  --
  + 获取数据()
  + 保持数据()
}

class "人脸识别" {
  - 人脸信息: string
  --
  + 执行识别()
}

class GPS {
  - 定位信息: string
  --
  + 获取定位()
  + 开始计时()
}

class "异常申诉" {
  - 学号: string
  - 申诉原因: string
  - 处理状态: string
  - 处理结果: string ' 明确数据类型
  --
  + 提交申诉()
  + 更新处理状态()
  + 提交处理结果()
}

class "运动规则" {
  - 学期最低跑步次数: int ' 删除重复属性
  - 男生配速上限: time
  - 女生配速上限: time
  - 晨跑开始时间: time
  - 晨跑结束时间: time
  - 跑步开始时间: time
  - 跑步结束时间: time
  - 电子围栏区间: memo
  --
  + 查询规则()
  + 更改规则()
}

' 继承关系，不使用“继承”文字，箭头朝向父类
"管理员" --|> "用户"
"学生" --|> "用户"

' 聚合关系，1个健康分析对应多个运动数据
"健康分析" "1" o-- "0..*" "运动数据" : 聚合

' 删除管理员对运动规则的简单依赖，改用关联+管理方法
"管理员" "1" --> "0..*" "运动规则" : 管理

' 删除学生与健康分析的依赖线，因学生持有健康分析实例

' 依赖关系保持合理性
"管理员" ..> "异常申诉" : 依赖
"学生" ..> "异常申诉" : 依赖
"学生" ..> "运动数据" : 依赖
"运动数据" ..> "异常申诉" : 依赖

' 运动数据关联GPS和人脸识别，使用组合或关联
"运动数据" "1" --> "1" GPS
"运动数据" "1" --> "1" "人脸识别"

@enduml